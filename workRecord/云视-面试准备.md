### 公司：深圳云视机器人有限公司
#### 面试时间：2025年10月17日 周五 上午10:00
#### 面试地点：深圳龙岗区仁恒梦创广场A塔3501
#### 公司产品 扫地机器人、宠物智能家电

#### 任职要求
##### 熟悉主流MCU架构及开发调试经验，精通c语言，熟悉RTOS系统优先
1. 内存与指针
    - 在一个32位MCU中，定义一个结构体 struct { char a; int b; char c; }，这个结构体的大小是多少？为什么？如何优化其内存占用？
    结构体大小：12字节；内存对齐；调整成员顺序
    - 请解释一下“野指针”和“内存泄漏”的成因、后果以及如何避免。
    野指针：
        成因：指针未初始化、指针释放后未置空，指针操作越界。
        后果：数据损坏、程序崩溃、难以调试。 
    内存泄漏：
        成因：malloc了的指针未释放
        后果：系统可用内存减少，性能下降，系统崩溃
    - const int *p, int * const p, 和 const int * const p 的区别是什么？在嵌入式编程中，const 关键字除了定义常量，还有什么重要作用？
        const int *p --> 指向常量的可变指针
        int * const p --> 常指针
        const int * const p --> 指向常量的常指针

2. volatile关键字与硬件操作
   - volatile关键字在嵌入式编程中至关重要，请描述三个必须使用它的典型场景。
        内存映射的外设寄存器
        在中断服务程序（ISR）中修改的全局变量
        多线程（RTOS任务）间共享的全局变量
   - 如果一个指针变量本身指向一个内存映射寄存器，应该如何声明？volatile应该放在哪里？
        volatile uint32_t * p 指向易变数据的指针
3. 中断服务程序与可重入性
   - 中断服务程序（ISR）有哪些限制？为什么不能在ISR中调用printf之类的标准库函数？
     执行时间必须尽可能短，不能阻塞，不能返回数值，小心处理共享数据
   - 什么是可重入函数？如何编写一个可重入的函数？
     一个函数如果可以被多个执行流同时调用而不会产生错误结果，就称为可重入函数。 
4. 架构对比与核心理解
   - 你熟悉的ARM Cortex-M系列内核（如M0, M3, M4）之间最主要的区别是什么？（例如性能、指令集、中断控制器等）
   - 请简述从单片机上电复位到执行main()函数之间，芯片内部完成了哪些关键步骤？
     硬件初始化 → 软件初始化 → 跳转主程序
   - 什么是中断向量表？它在MCU启动和运行时是如何被使用的？
     中断向量表是一个存储在固定内存地址（通常是Flash起始地址）的函数指针数组。
     中断向量表就是一张“应急事件处理预案表”，它明确规定了：当发生特定事件（中断）时，CPU应该立刻去找谁（哪个函数）来处理。 
5. 外设与驱动开发
   - 配置一个UART通信需要设置哪些关键参数？如果通信中出现乱码，你的排查思路是什么？
   波特率、起始位、数据位、停止位
   - I2C和SPI在协议层、硬件层和应用层各有什么优缺点？你如何在二者之间做选择？
6. 调试经验
   - 请分享一次你使用示波器或逻辑分析仪解决复杂硬件/软件交互问题的经历。
   - 如果你的程序突然跑飞（进入HardFault），你的调试步骤是什么？
   - 除了调试器，你还用过哪些方法来定位问题？（例如：printf日志、IO口翻转计时、LED指示灯等）
7. 核心概念
   -  为什么在项目中选择使用RTOS？它相比裸机前后台系统（超级循环）带来了哪些好处和代价？
   -  请解释任务（Task）的“就绪态”、“阻塞态”和“挂起态”有什么区别？任务因等待一个信号量而进入的是什么状态？
        就绪态：任务已经准备好运行，只等待调度器把CPU分配给它。
        阻塞态：任务因为等待某个事件或资源而主动暂停运行。
        挂起态：任务被强制或被动地停止运行，与它当前要做什么无关。除非被明确恢复，否则它将永远不被调度。  
8. 任务通信与同步
   - 队列（Queue）、信号量（Semaphore）和互斥量（Mutex）分别用于解决什么问题？请举例说明。
     队列 - 用于传输数据，任务间的数据传递。
     信号量 - 用于任务同步或资源计数，任务间的同步和管理一组同类资源
     互斥量 - 用于保护共享资源，资源互斥访问
   - 信号量和互斥量最核心的区别是什么？
        一个用于同步 一个用于保护
   - 什么是消息队列？它相比全局数组+信号量的组合有什么优势？
9. 实战陷阱
   - 在RTOS中，堆栈溢出是一个常见问题。你有哪些方法来监控和预防任务堆栈溢出？
10. 嵌入式相关宏定义/位操作
    -  编写一个宏，用于将指定寄存器的某一位清零。例如 CLEAR_BIT(REG, BIT)。
    -  实现一个简单的字节流CRC8校验函数。
11. 数据结构与算法
    - 用C语言实现一个环形缓冲区（Circular Buffer），并写出入队和出队函数。
12. RTOS编程思想
    - 假设有两个任务：一个“按键扫描任务”和一个“LED控制任务”。要求按键按下后，LED改变状态。请描述你的设计思路，包括使用哪种任务间通信机制，并说明理由。

##### 熟练掌握I2C、SPI、UART、ADC、TIMER、RTC、PWM等外设

##### 32位单片机软件开发经验
